<div class="main">
    <div class="flex-container">
        <div class="cadre" [style.min-height]="cardContentHeight + 'px'">
            <div id="details">
                <gn-cmr-breadcrumb [path]="path" [currentPage]="module.forms.visit.label"></gn-cmr-breadcrumb>
                <div class="toolbar clearfix">
                    <h3 class="float-left">{{module.forms.visit.label}}</h3>
                    <button class="btn btn-primary float-right" [routerLink]="['..', {edit: visit.id_visit}]"><i class="fa fa-pencil"></i>&nbsp;Editer</button>
                </div>
                <div class="">
                    <nav>
                        <table class="table table-striped table-sm scrollable">
                            <tr *ngFor="let fieldName of properties">
                                <th>{{ fields[fieldName].attribut_label }}</th>
                                <td class="text-in-area">{{ _dataService.formatProperty(visit[fieldName], fields[fieldName])}}</td>
                            </tr>
                        </table>
                    </nav>
                </div>
            </div>
            <pnx-map height="40vh" class="map-card">
                <pnx-geojson
                    *ngIf="mapFeatures && mapFeatures['features']"
                    [geojson]="mapFeatures"
                    [zoomOnLayer]="true"
                    [zoomOnFirstTime]="true"
                ></pnx-geojson>
            </pnx-map>
        </div>
        <div class="cadre scroll">
            <div class="" *ngIf="visit.observation">
                <h3>{{module.forms.observation.label_plural}}</h3>
                <div class="toolbar clearfix">
                    <button class="btn btn-success float-left" (click)="onClickAddObservation()"><i class="fa fa-plus-circle"></i>&nbsp;Ajout Observation</button>
                </div>
                <ngx-datatable #table
                    class="material striped margin-top-xs"
                    [rows]="observations"
                    [rowHeight]="40"
                    [draggable]="false"
                    [count]="observations.length"
                    [limit]="15"
                    [headerHeight]="50"
                    [footerHeight]="50">

                    <ngx-datatable-column width="60">
                        <ng-template let-row="row" ngx-datatable-cell-template>
                            <a class="clickable btn btn-no-padding bt-ghost" [routerLink]="['observation', row.id_observation]">
                                <i class="fa fa-info-circle" aria-hidden="true" [matTooltip]="'DÃ©tails ' + module.forms.observation.label"></i>
                            </a>
                            <a class="clickable btn btn-no-padding bt-ghost ml-1" [routerLink]="['individual', row.id_individual, 'observation', {edit: row.id_observation}]">
                                <i class="fa fa-pencil-square-o" aria-hidden="true" [matTooltip]="'Editer ' + module.forms.observation.label"></i>
                            </a>
                        </ng-template>
                    </ngx-datatable-column>
                    <ngx-datatable-column *ngFor="let prop of observationListProperties" [width]="prop.width" [name]="observationFieldsDef[prop.field].attribut_label" [prop]="prop.field" [cellClass]="'text-' + (prop['align'] ? prop['align'] : 'left')" >
                        <ng-template let-row="row" ngx-datatable-cell-template>
                            <span>{{_dataService.formatProperty(row[prop.field], observationFieldsDef[prop.field])}}</span>
                        </ng-template>
                    </ngx-datatable-column>
                </ngx-datatable>
            </div>
        </div>
    </div>
</div>
