<div class="main">
    <div class="flex-container">
        <div class="cadre" [style.min-height]="cardContentHeight + 'px'">
            <pnx-map height="100%" class="map-card">
                <pnx-leaflet-draw 
                    [geojson]="geometry" 
                    [options]="leafletDrawOptions" 
                    [zoomLevel]="14"
                    (layerDrawed)="setNewGeometry($event)"
                    (layerDeleted)="setNewGeometry(undefined)">
                </pnx-leaflet-draw>
            </pnx-map>
        </div>
        <div class="cadre scroll">
            <gn-cmr-breadcrumb [path]="path" [currentPage]="(bEdit ? 'Edition ' : 'Création ')+ module.forms.site.label + (bEdit ? ' ' + site.name : '')"></gn-cmr-breadcrumb>
            <h3>Module: {{ module.module_label }}</h3>
            <div class="clearfix">
              <h4 class="float-left">{{ bEdit ? 'Edition' : 'Création'}} {{module.forms.site.label}} {{bEdit ? ': ' + site.name : ''}}</h4>
              <span class="float-right" *ngIf="!bEdit">
                <i class="fa fa-repeat fa-lg"></i>
                <mat-slide-toggle id="repeat" color="primary" [(ngModel)]="bChainInput"></mat-slide-toggle>
              </span>
            </div>
            <form [formGroup]="siteForm">
              <!--<p style="color:red" *ngIf="obj.config['geometry_type'] && !objForm.value.geometry">
                Veuillez saisir une géométrie sur la carte
              </p>-->
              <pnx-dynamic-form-generator
                class="obj-form"
                #dynamicForm
                [autoGenerated]="true"
                [myFormGroup]="siteForm"
                [formsDefinition]="siteFormDefinitions"
              ></pnx-dynamic-form-generator>

              <div class="clearfix">
                <button class="btn btn-primary float-left" [routerLink]="['..']" *ngIf="!bEdit">Annuler</button>
                <button class="btn btn-primary float-left" [routerLink]="['..', 'site', site.id_site]" *ngIf="bEdit">Annuler</button>
                <button *ngIf="!bChainInput  && !bEdit" class="btn btn-success float-right" [disabled]="!siteForm.valid" (click)="onSubmit(true)"><i class="fa fa-check"></i>&nbsp;Valider et ajouter {{module.forms.visit.label}}</button>
                <button *ngIf="!bChainInput" class="btn btn-success float-right mr-2" [disabled]="!siteForm.valid" (click)="onSubmit(false)"><i class="fa fa-check"></i>&nbsp;Valider</button>
                <button *ngIf="bChainInput" class="btn btn-success float-right" [disabled]="!siteForm.valid" (click)="onSubmit(false)"><i class="fa fa-check"></i>&nbsp;Valider et enchainer les saisies</button>
              </div>
      
            </form>
        </div> 
    </div>
</div>
